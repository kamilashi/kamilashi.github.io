
<style>
  .page-content
  {
    position: absolute;
    width: calc(var(--page-width) + 6em);
    height: auto;
    z-index: 20;         
    right: 5em;
    overflow-x: hidden;
  }

  .page-content[data-open="true"]{
    width: calc(var(--page-width) + 6em);
    transition: width 0.3s ease-out;
  }

  .page-content[data-open="false"]{
    width: 0;
    transition: width 0.3s ease-out;
  }
  
  .w {
    pointer-events: auto !important;
    padding-top: 1px !important;
    width: var(--page-width) !important;
  }

  .back-home-link{
    position: sticky !important;
    width: 100%;
    height: auto;
    padding-top: 2rem;
    padding-bottom: 0.3rem;
    padding-inline: 3rem;
    z-index: 30;         
    background-color: var(--bg);  
    cursor: pointer;
    /* display: flex; */
  }
</style>

<canvas id="bg-canvas" aria-hidden="true"></canvas>

  {% include toggle_theme_button.html %}

  <div id="project-card-layer">
  {% for item in site.data.home.project_entries %}
    <div id="s0e{{ forloop.index0 }}" class="project-card" aria-hidden="true" data-image=".{{ item.image}}">
      {% include new-bg-card.html cardItem = item %}
    </div>
  {% endfor %}
  {% for item in site.data.home.old_project_entries %}
    <div id="s1e{{ forloop.index0 }}" class="project-card" aria-hidden="true" data-image=".{{ item.image}}">
      {% include new-bg-card.html cardItem = item %}
    </div>
  {% endfor %}
  </div>

  <style>

    #project-card-layer{
      position: fixed;
      top: 5rem;
      right: 6rem;   
      width: 35rem;        
      aspect-ratio: 1 / 1;      
      z-index: 20;             
      pointer-events: none;    
    }

    #project-card-layer .project-card{
      position: absolute;
      inset: 0;                
      opacity: 0;
      pointer-events: none;
    }

    #project-card-layer .project-card[data-open="true"]{
      opacity: 1;
      transition: opacity 1.0s ease;
    }

    #project-card-layer .project-card[data-open="false"]{
      opacity: 0;
      transition: opacity 1.0s ease;
    }

    #bg-canvas{
      position: fixed;
      inset: 0;
      width: 100vw;
      height: 100vh;
      z-index: 1;            
    }

    /* Respect reduced motion */
    @media (prefers-reduced-motion: reduce) {
      #bg-canvas { display: none; }
    }
  </style>

<script type="importmap">
{
  "imports": {
    "three": "https://unpkg.com/three@0.180.0/build/three.module.js",

    "three/postprocessing/EffectComposer": "https://unpkg.com/three@0.180.0/examples/jsm/postprocessing/EffectComposer.js",
    "three/postprocessing/Pass":           "https://unpkg.com/three@0.180.0/examples/jsm/postprocessing/Pass.js",
    "three/postprocessing/RenderPass":     "https://unpkg.com/three@0.180.0/examples/jsm/postprocessing/RenderPass.js",
    "three/postprocessing/ShaderPass":     "https://unpkg.com/three@0.180.0/examples/jsm/postprocessing/ShaderPass.js",
    "bidi-js": "https://cdn.jsdelivr.net/npm/bidi-js@1.0.3/dist/bidi.mjs",
    "webgl-sdf-generator": "https://cdn.jsdelivr.net/npm/webgl-sdf-generator@1.1.1/dist/webgl-sdf-generator.mjs",
    "troika-worker-utils": "https://cdn.jsdelivr.net/npm/troika-worker-utils@0.52.0/dist/troika-worker-utils.esm.js",
    "troika-three-utils": "https://cdn.jsdelivr.net/npm/troika-three-utils@0.52.4/dist/troika-three-utils.esm.js",
    "troika-three-text": "https://cdn.jsdelivr.net/npm/troika-three-text@0.52.4/dist/troika-three-text.esm.js",

    "three/shaders/CopyShader": "https://unpkg.com/three@0.180.0/examples/jsm/shaders/CopyShader.js",
    "three/shaders/FXAAShader": "https://unpkg.com/three@0.180.0/examples/jsm/shaders/FXAAShader.js",

    "three/controls/OrbitControls": "https://unpkg.com/three@0.180.0/examples/jsm/controls/OrbitControls.js",
    "three/loaders/GLTFLoader":     "https://unpkg.com/three@0.180.0/examples/jsm/loaders/GLTFLoader.js",

    "lil-gui": "https://cdn.jsdelivr.net/npm/lil-gui@0.20/dist/lil-gui.esm.js",

    "app/Noises":       "../assets/threejs/Noises.js",
    "app/Helpers":      "../assets/threejs/Helpers.js",
    "app/OutlinePass":  "../assets/background/outline-pass.js",
    "app/ThemeToggle":  "../assets/background/theme-toggle.js",

    "app/main":         "../assets/background/animated-bg3.js"
  }
}
</script>

<!-- App entry: load your ESM file that uses the aliases above -->
<script type="module">
  import "app/main";
</script>

